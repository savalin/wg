# Wait group #

WaitGroup -  это альтернативная реализация [sync.WaitGroup](https://golang.org/pkg/sync/#WaitGroup) с расширенными возможностями.

Особенности: 

* остановка всех горутин если хотя бы одна завершилась ошибкой
* выполнение всех горутин и сбор ошибок
* обработка паник в горутинах
* таймаут: через context.Context или через метод


## Использование
### Общее
```go

// ...

var wg = wg.New()

// опционально
wg.WithContext(ctx)

wg.Add(
    // Добавляем первую гоуртину
    func(ctx context.Context) error {
        // какая-то логика
        return nil
    },
    
    // Добавляем вторую горутину
    func(ctx context.Context) error {
        // какая-то логика
        return nil
    },     
    
    // Добавляем еще горутины если необходимо
    // ...
)

wg.Start()
```

### Обработка ошибок
#### остановка по первой ошибке
```go
var wg = wg.New()

// добавляем горутины в очередь
// ...

var err error
err = wg.
        SetStopOnError(true).
        Start().
        GetLastError()

// обрабатываем ошибку из горутины
// ...
```

#### выполнение всех горутин и сбор ошибок
```go
var wg = wg.New()

// добавляем горутины в очередь
// ...

var errs []error
errs = wg.
        Start().
        GetAllErrors()

// обрабатываем слайс ошибок вернувшихся из горутин
// ...

```

### Таймаут
#### если у вас есть контекст (ctx conext.Context)
```go
var wg = wg.New()

// контекст будет доступен в горутинах, а также применен таймаут из конткста
wg.WithContext(ctx)

// добавляем горутины в очередь
// ...

wg.Start()

```

#### если у вас нет контекста
```go
var wg = wg.New()

// добавляем горутины в очередь
// ...

wg.
    SetTimeout(time.Second).
    Start()

```

### Сброс и последующее использование
```go
var wg = wg.New()

// добавляем горутины в очередь
// ...

wg.Start()

// Сброс состояния для последующего переиспользования с нуля
wg.Reset()

// добавляем горутины в очередь и устанавливаем параметры
// ...

```